The sign code is taken from https://github.com/asuleymanov/rpc/tree/master/transactions with some adoptions